(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[196],{5196:function(e,t,n){"use strict";var r=n(4111),s=n(7568),o=n(1438),i=n(2951),a=n(4924),l=n(8029),c=n(5950),u=n(4051),d=n.n(u),h=n(5893),g=n(7294),p=n(4623),m=n(3623),y=n(8005),f=n(8936),x=n(967),j=n(8156),Z=n(5150),w=n(3536),S=n.n(w),v=n(6245),C=n(1163),b=n.n(C),k=n(8286),T=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(e){var i;(0,o.Z)(this,n),i=t.call(this,e),(0,a.Z)((0,r.Z)(i),"state",{username:"",password:"",email:"",nywila:"",message:"",message2:"",loading:!1}),(0,a.Z)((0,r.Z)(i),"onRegister",(function(e){return i.setState({loading:!0}),e.preventDefault(),0===i.state.username.trim().length||0===i.state.password.trim().length?(i.setState({message:"We don't accept empty field"}),i.errorContainer.current.style.display="block",i.errorShow=setTimeout((function(){i.errorContainer.current.style.display="none"}),5e3),void i.setState({loading:!1})):i.state.password.trim().length<6?(i.setState({message:"Shorter password less than6 characters"}),i.errorContainer.current.style.display="block",i.errorShow=setTimeout((function(){i.errorContainer.current.style.display="none"}),5e3),void i.setState({loading:!1})):i.state.username.trim().includes("@")?void fetch("".concat(k.Z,"/api/register/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:i.state.username,password:i.state.password})}).then((function(e){return e.json()})).then((function(e){if(e.err)return console.log(e.err),i.setState({message:"Failed!, the user of this email already exist"}),i.errorContainer.current.style.display="block",i.timeout1=setTimeout((function(){i.errorContainer.current.style.display="none"}),5e3),void i.setState({loading:!1});if(e.error)return i.setState({message:"Failed!, Invalid data"}),i.errorContainer.current.style.display="block",i.timeout1=setTimeout((function(){i.errorContainer.current.style.display="none"}),5e3),void i.setState({loading:!1});console.log("Everyting is good bro..."),i.setState({loading:!1}),i.errorContainer1.current.style.display="block";var t=(0,r.Z)(i);i.timeout2=setTimeout((0,s.Z)(d().mark((function e(){var n,r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("we should login this user"),e.next=3,fetch("".concat(k.Z,"/api/token/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t.state.username,password:t.state.password})});case 3:return n=e.sent,e.next=6,n.json();case 6:if(r=e.sent,console.log("gza",r),200===n.status){e.next=10;break}return e.abrupt("return",console.log("Error to login this user, status code of 200 is returned"));case 10:localStorage.setItem("authTokens",JSON.stringify(r)),t.errorContainer1.current.style.display="none",t.props.closeLoginPanel();case 13:case"end":return e.stop()}}),e)}))),100)})):(i.setState({message:"Wrong format of email"}),i.errorContainer.current.style.display="block",i.errorShow=setTimeout((function(){i.errorContainer.current.style.display="none"}),5e3),void i.setState({loading:!1}))}));var l=(0,r.Z)(i);return(0,a.Z)((0,r.Z)(i),"onLogin",function(){var e=(0,s.Z)(d().mark((function e(t){var n,r,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),0!==l.state.email.trim().length&&0!==l.state.nywila.trim().length){e.next=7;break}return l.setState({message2:"We don't accept empty field"}),l.loginError.current.style.display="block",l.errorShow2=setTimeout((function(){l.loginError.current.style.display="none"}),5e3),l.setState({loading:!1}),e.abrupt("return");case 7:return e.next=9,fetch("".concat(k.Z,"/api/token/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l.state.email,password:l.state.nywila})});case 9:return n=e.sent,e.next=12,n.json();case 12:if(r=e.sent,console.log("data",r),200==n.status){e.next=20;break}return l.setState({message2:"Unable to login, Bad credentials!"}),console.log("Bad credentials"),l.loginError.current.style.display="block",l.loginSetTimeout=setTimeout((function(){l.loginError.current.style.display="none"}),5e3),e.abrupt("return");case 20:console.log("Everything is good, you have good credentails..."),console.log("this is the id of the user"),s=(0,v.Z)(r.access),console.log("This is decoded jwt token..."),console.log(s),console.log(s.user_id),localStorage.setItem("authTokens",JSON.stringify(r)),console.log("Mpaka hatua hii inabid u-close hii window coz user ashalogin"),l.loginSuccess.current.style.display="block",l.successSetTimeOut=setTimeout((function(){l.loginSuccess.current.style.display="none",l.props.closeLoginPanel()}),1e3);case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),i.errorContainer=g.createRef(),i.errorContainer1=g.createRef(),i.loginError=g.createRef(),i.loginSuccess=g.createRef(),i}return(0,i.Z)(n,[{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout1),clearTimeout(this.timeout2),clearTimeout(this.loginSetTimeout),clearTimeout(this.successSetTimeOut),clearTimeout(this.errorShow),clearTimeout(this.errorShow2)}},{key:"render",value:function(){var e=this;return(0,h.jsx)("div",{className:S().father,children:(0,h.jsxs)(p.Z,{children:[(0,h.jsx)(m.Z,{as:"h1",content:"To have many more features like adding items to shoping cart you should login.",color:"grey",textAlign:"center"}),(0,h.jsx)("hr",{style:{border:"1px solid grey"}}),(0,h.jsxs)(y.Z,{children:[(0,h.jsx)(y.Z.Column,{width:10,children:(0,h.jsxs)(p.Z,{children:[(0,h.jsxs)(m.Z,{as:"h2",children:[" ","You don't have account? Create one for you."]}),(0,h.jsxs)(f.Z,{children:[(0,h.jsxs)(f.Z.Group,{widths:"equal",children:[(0,h.jsx)(f.Z.Input,{fluid:!0,label:"Username",onChange:function(t){return e.setState({username:t.target.value})}}),(0,h.jsx)(f.Z.Input,{fluid:!0,label:"Password",type:"password",onChange:function(t){return e.setState({password:t.target.value})}})]}),(0,h.jsx)(x.Z,{loading:this.state.loading,type:"submit",content:"Register",fluid:!0,primary:!0,onClick:this.onRegister})]}),(0,h.jsx)("div",{className:S().cont,ref:this.errorContainer,children:(0,h.jsxs)(j.Z,{error:!0,children:[(0,h.jsx)(j.Z.Header,{children:"Error, unable create account!"}),(0,h.jsx)(Z.Z,{name:"warning sign"}),this.state.message]})}),(0,h.jsx)("div",{className:S().cont2,ref:this.errorContainer1,children:(0,h.jsxs)(j.Z,{success:!0,children:[(0,h.jsx)(j.Z.Header,{children:"Account created successful"}),"Now you can login with your password and email as username"]})})]})}),(0,h.jsx)(y.Z.Column,{width:6,children:(0,h.jsxs)(p.Z,{children:[(0,h.jsxs)("span",{className:S().spt,children:["Already have account",(0,h.jsx)(Z.Z,{name:"question"}),"Login here"]}),(0,h.jsx)("hr",{}),(0,h.jsxs)(f.Z,{children:[(0,h.jsxs)(f.Z.Field,{children:[(0,h.jsx)("label",{children:"Username"}),(0,h.jsx)("input",{onChange:function(t){return e.setState({email:t.target.value})}})]}),(0,h.jsxs)(f.Z.Field,{children:[(0,h.jsx)("label",{children:"Password"}),(0,h.jsx)("input",{onChange:function(t){return e.setState({nywila:t.target.value})},type:"password"})]}),(0,h.jsx)("p",{className:S().fp,onClick:function(){return b().push("/reset")},children:"Forgot password?"}),(0,h.jsxs)(x.Z,{animated:"vertical",fluid:!0,color:"teal",onClick:this.onLogin,children:[(0,h.jsx)(x.Z.Content,{visible:!0,children:"Login"}),(0,h.jsx)(x.Z.Content,{hidden:!0,children:(0,h.jsx)(Z.Z,{name:"arrow right"})})]})]}),(0,h.jsx)("div",{ref:this.loginError,style:{display:"none",marginTop:"1%"},children:(0,h.jsxs)(j.Z,{error:!0,children:[(0,h.jsx)(j.Z.Header,{children:"Unauthorized"}),(0,h.jsx)(Z.Z,{name:"warning sign"}),this.state.message2]})}),(0,h.jsx)("div",{ref:this.loginSuccess,style:{display:"none",marginTop:"1%"},children:(0,h.jsxs)(j.Z,{success:!0,children:[(0,h.jsx)(j.Z.Header,{children:"Login successful"}),"Now you're free to add items to the cart"]})})]})})]})]})})}}]),n}(g.Component);t.Z=T},3536:function(e){e.exports={spt:"sign_spt__vpeQV",cont:"sign_cont__9g5Ro",cont2:"sign_cont2__0kzC7",fp:"sign_fp___z0GJ"}}}]);