(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[495],{5511:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/register",function(){return n(72)}])},72:function(e,t,n){"use strict";n.r(t);var r=n(4111),s=n(7568),o=n(1438),a=n(2951),i=n(4924),l=n(8029),c=n(5950),u=n(4051),d=n.n(u),h=n(5893),p=n(7294),g=n(8019),m=n(8005),f=n(4623),y=n(3623),Z=n(8936),v=n(967),x=n(8156),w=n(5150),k=n(8286),S=n(6583),j=n.n(S),T=n(6245),C=n(6215),b=function(e){(0,l.Z)(n,e);var t=(0,c.Z)(n);function n(e){var a;(0,o.Z)(this,n),a=t.call(this,e),(0,i.Z)((0,r.Z)(a),"state",{isAunthenticated:!1,username:"",password:"",email:"",nywila:"",message:"",message1:"",message3:"",loading:!1}),(0,i.Z)((0,r.Z)(a),"executingTokenLogics",(function(){try{var e=localStorage.getItem("authTokens")?JSON.parse(localStorage.getItem("authTokens")):null;if(!e)return console.log("You needed to login, no records"),void a.setState({isAunthenticated:!1});var t=(0,T.Z)(e.refresh).exp;console.log("Hey this is the expire date of the refreshToken"),console.log(t),console.log("Lets try to access the json access token"),console.log(e.access);var n=(0,T.Z)(e.access);console.log("This is expiring time for you..."),console.log(n);var r=n.exp;if(console.log(r),1e3*r-Date.now()<1){if(console.log("Hey we need to either update or make user login again"),1e3*t-Date.now<1)return console.log("Even ur refresh token has already been expired we need you to login again...."),void a.setState({isAunthenticated:!1});console.log("Our refresh token is alive you should use it to update your access token"),a.updateToken(e.refresh),a.setState({isAunthenticated:!0}),C.Router.push({pathname:"/profile"})}else a.setState({isAunthenticated:!0}),C.Router.push({pathname:"/profile"})}catch(s){console.log(s.message),console.log("Invalid token specified since, when the token is expired the jwt automatically change your storage and it ill look like this"),a.setState({isAunthenticated:!1})}})),(0,i.Z)((0,r.Z)(a),"updateToken",function(){var e=(0,s.Z)(d().mark((function e(t){var n,r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(k.Z,"/api/token/refresh/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:t})});case 2:return n=e.sent,e.next=5,n.json();case 5:r=e.sent,localStorage.setItem("authTokens",JSON.stringify(r));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,i.Z)((0,r.Z)(a),"onRegister",(function(e){return a.setState({loading:!0}),console.log("these are username and passwords"),console.log(a.state.password,a.state.username),e.preventDefault(),0===a.state.username.trim().length||0===a.state.password.trim().length?(a.setState({message:"We don't accept empty field"}),a.errorContainer.current.style.display="block",a.errorShow=setTimeout((function(){a.errorContainer.current.style.display="none"}),5e3),void a.setState({loading:!1})):a.state.password.trim().length<6?(a.setState({message:"Shorter password less than 6 characters"}),a.errorContainer.current.style.display="block",a.errorShow=setTimeout((function(){a.errorContainer.current.style.display="none"}),5e3),void a.setState({loading:!1})):a.state.username.trim().includes("@")?void fetch("".concat(k.Z,"/api/register/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a.state.username,password:a.state.password})}).then((function(e){return e.json()})).then((function(e){if(e.err)return a.setState({message:"Failed!, the user of this email already exist"}),a.errorContainer.current.style.display="block",a.timeout1=setTimeout((function(){a.errorContainer.current.style.display="none"}),5e3),void a.setState({loading:!1});if(e.error)return a.setState({message:"Failed!, Invalid data"}),a.errorContainer.current.style.display="block",a.timeout1=setTimeout((function(){a.errorContainer.current.style.display="none"}),5e3),void a.setState({loading:!1});console.log("Everything is good bro..."),a.setState({message1:"Everything is good"}),a.errorContainer1.current.style.display="block";var t=(0,r.Z)(a);a.timeout2=setTimeout((0,s.Z)(d().mark((function e(){var n,r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("we should login this user"),e.next=3,fetch("".concat(k.Z,"/api/token/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t.state.username,password:t.state.password})});case 3:return n=e.sent,e.next=6,n.json();case 6:if(r=e.sent,200===n.status){e.next=9;break}return e.abrupt("return",console.log("Error to login this user, status code of 200 is returned"));case 9:localStorage.setItem("authTokens",JSON.stringify(r)),t.errorContainer1.current.style.display="none",t.setState({loading:!1}),t.props.flag?C.Router.push({pathname:t.props.flag}):C.Router.push("/");case 13:case"end":return e.stop()}}),e)}))))})):(a.setState({message:"Wrong format of email"}),a.errorContainer.current.style.display="block",a.errorShow=setTimeout((function(){a.errorContainer.current.style.display="none"}),5e3),void a.setState({loading:!1}))}));var l=(0,r.Z)(a);return(0,i.Z)((0,r.Z)(a),"onLogin",function(){var e=(0,s.Z)(d().mark((function e(t){var n,r,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),0!==l.state.email.trim().length&&0!==l.state.nywila.trim().length){e.next=7;break}return l.setState({message3:"We don't accept empty field"}),l.loginError.current.style.display="block",l.errorShow2=setTimeout((function(){l.loginError.current.style.display="none"}),5e3),l.setState({loading:!1}),e.abrupt("return");case 7:return console.log(l.state.email,l.state.nywila),e.next=10,fetch("".concat(k.Z,"/api/token/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l.state.email,password:l.state.nywila})});case 10:return n=e.sent,e.next=13,n.json();case 13:if(r=e.sent,console.log("data: ",r),200===n.status){e.next=21;break}return console.log("Bad credentials"),l.setState({message3:"Unable to login, Bad credentials!"}),l.loginError.current.style.display="block",l.errorTimeout=setTimeout((function(){l.loginError.current.style.display="none"}),5e3),e.abrupt("return");case 21:console.log("everything is good, you have good credentials..."),console.log("this is the id of the user"),s=(0,T.Z)(r.access),console.log("This is decoded jwd token...."),console.log(s),console.log(s.user_id),localStorage.setItem("authTokens",JSON.stringify(r)),l.props.flag?C.Router.push({pathname:l.props.flag}):C.Router.push("/");case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.errorContainer=p.createRef(),a.errorContainer1=p.createRef(),a.loginError=p.createRef(),a}return(0,a.Z)(n,[{key:"componentDidMount",value:function(){this.executingTokenLogics()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.errorTimeout),clearTimeout(this.errorShow),clearTimeout(this.errorShow2)}},{key:"render",value:function(){var e=this;return(0,h.jsx)(g.Z,{children:(0,h.jsx)("div",{className:j().father,children:(0,h.jsxs)(m.Z,{children:[(0,h.jsx)(m.Z.Column,{width:10,children:(0,h.jsxs)(f.Z,{children:[(0,h.jsx)(y.Z,{as:"h2",children:"You dont have Account? Create one for you."}),(0,h.jsxs)(Z.Z,{children:[(0,h.jsxs)(Z.Z.Group,{widths:"equal",children:[(0,h.jsx)(Z.Z.Input,{fluid:!0,label:"Email",onChange:function(t){return e.setState({username:t.target.value})}}),(0,h.jsx)(Z.Z.Input,{fluid:!0,label:"Password",type:"password",onChange:function(t){return e.setState({password:t.target.value})}})]}),(0,h.jsx)(v.Z,{loading:this.state.loading,type:"submit",content:"Register",fluid:!0,primary:!0,onClick:this.onRegister})]}),(0,h.jsx)("div",{className:j().cont,ref:this.errorContainer,children:(0,h.jsxs)(x.Z,{error:!0,children:[(0,h.jsx)(x.Z.Header,{children:"Error, unable create account!"}),(0,h.jsx)(w.Z,{name:"warning sign"}),this.state.message]})}),(0,h.jsx)("div",{className:j().cont2,ref:this.errorContainer1,children:(0,h.jsxs)(x.Z,{success:!0,children:[(0,h.jsx)(x.Z.Header,{children:"Account created successful"}),this.state.message1]})})]})}),(0,h.jsx)(m.Z.Column,{width:6,children:(0,h.jsxs)(f.Z,{children:[(0,h.jsxs)("span",{className:j().spt,children:["Already have account",(0,h.jsx)(w.Z,{name:"question"})," Login here"]}),(0,h.jsx)("hr",{}),(0,h.jsxs)(Z.Z,{children:[(0,h.jsxs)(Z.Z.Field,{children:[(0,h.jsx)("label",{children:"Email"}),(0,h.jsx)("input",{onChange:function(t){return e.setState({email:t.target.value})}})]}),(0,h.jsxs)(Z.Z.Field,{children:[(0,h.jsx)("label",{children:"Password"}),(0,h.jsx)("input",{type:"password",onChange:function(t){return e.setState({nywila:t.target.value})}})]}),(0,h.jsx)("p",{className:j().fp,onClick:function(){return C.Router.push("/reset")},children:"Forgot password?"}),(0,h.jsxs)(v.Z,{animated:"vertical",fluid:!0,color:"teal",onClick:this.onLogin,children:[(0,h.jsx)(v.Z.Content,{visible:!0,children:"Login"}),(0,h.jsx)(v.Z.Content,{hidden:!0,children:(0,h.jsx)(w.Z,{name:"arrow right"})})]})]}),(0,h.jsx)("div",{ref:this.loginError,style:{display:"none",marginTop:"1%"},children:(0,h.jsxs)(x.Z,{error:!0,children:[(0,h.jsx)(x.Z.Header,{children:"Unauthorized "}),(0,h.jsx)(w.Z,{name:"warning sign"}),this.state.message3]})})]})})]})})})}}],[{key:"getInitialProps",value:function(e){return(0,s.Z)(d().mark((function t(){var n;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.query.flag,t.abrupt("return",{flag:n});case 2:case"end":return t.stop()}}),t)})))()}}]),n}(p.Component);t.default=b},6583:function(e){e.exports={father:"register_father__9Sa5p",spt:"register_spt__93hvx",hr:"register_hr__fIMue",cont:"register_cont__hh89I",cont2:"register_cont2__MeQWT",loginError:"register_loginError__nCs1L",fp:"register_fp__4VdDS"}},8156:function(e,t,n){"use strict";n.d(t,{Z:function(){return S}});var r=n(7462),s=n(5068),o=n(7601),a=n(6010),i=n(7294),l=n(8459),c=n(8935),u=n(2519),d=n(2248),h=n(9591),p=n(5150);function g(e){var t=e.children,n=e.className,s=e.content,o=(0,a.Z)("content",n),l=(0,c.Z)(g,e),h=(0,u.Z)(g,e);return i.createElement(h,(0,r.Z)({},l,{className:o}),d.kK(t)?s:t)}g.handledProps=["as","children","className","content"],g.propTypes={};var m=g;function f(e){var t=e.children,n=e.className,s=e.content,o=(0,a.Z)("header",n),l=(0,c.Z)(f,e),h=(0,u.Z)(f,e);return i.createElement(h,(0,r.Z)({},l,{className:o}),d.kK(t)?s:t)}f.handledProps=["as","children","className","content"],f.propTypes={},f.create=(0,h.u5)(f,(function(e){return{content:e}}));var y=f,Z=n(3871);function v(e){var t=e.children,n=e.className,s=e.content,o=(0,a.Z)("content",n),l=(0,c.Z)(v,e),h=(0,u.Z)(v,e);return i.createElement(h,(0,r.Z)({},l,{className:o}),d.kK(t)?s:t)}v.handledProps=["as","children","className","content"],v.propTypes={},v.defaultProps={as:"li"},v.create=(0,h.u5)(v,(function(e){return{content:e}}));var x=v;function w(e){var t=e.children,n=e.className,s=e.items,o=(0,a.Z)("list",n),l=(0,c.Z)(w,e),h=(0,u.Z)(w,e);return i.createElement(h,(0,r.Z)({},l,{className:o}),d.kK(t)?(0,Z.Z)(s,x.create):t)}w.handledProps=["as","children","className","items"],w.propTypes={},w.defaultProps={as:"ul"},w.create=(0,h.u5)(w,(function(e){return{items:e}}));var k=w,S=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=e.call.apply(e,[this].concat(r))||this).handleDismiss=function(e){var n=t.props.onDismiss;n&&n(e,t.props)},t}return(0,s.Z)(t,e),t.prototype.render=function(){var e=this.props,n=e.attached,s=e.children,g=e.className,f=e.color,Z=e.compact,v=e.content,x=e.error,w=e.floating,S=e.header,j=e.hidden,T=e.icon,C=e.info,b=e.list,N=e.negative,_=e.onDismiss,E=e.positive,G=e.size,P=e.success,O=e.visible,I=e.warning,R=(0,a.Z)("ui",f,G,(0,l.lG)(Z,"compact"),(0,l.lG)(x,"error"),(0,l.lG)(w,"floating"),(0,l.lG)(j,"hidden"),(0,l.lG)(T,"icon"),(0,l.lG)(C,"info"),(0,l.lG)(N,"negative"),(0,l.lG)(E,"positive"),(0,l.lG)(P,"success"),(0,l.lG)(O,"visible"),(0,l.lG)(I,"warning"),(0,l.sU)(n,"attached"),"message",g),D=_&&i.createElement(p.Z,{name:"close",onClick:this.handleDismiss}),A=(0,c.Z)(t,this.props),K=(0,u.Z)(t,this.props);return d.kK(s)?i.createElement(K,(0,r.Z)({},A,{className:R}),D,p.Z.create(T,{autoGenerateKey:!1}),(!(0,o.Z)(S)||!(0,o.Z)(v)||!(0,o.Z)(b))&&i.createElement(m,null,y.create(S,{autoGenerateKey:!1}),k.create(b,{autoGenerateKey:!1}),(0,h.BU)(v,{autoGenerateKey:!1}))):i.createElement(K,(0,r.Z)({},A,{className:R}),D,s)},t}(i.Component);S.handledProps=["as","attached","children","className","color","compact","content","error","floating","header","hidden","icon","info","list","negative","onDismiss","positive","size","success","visible","warning"],S.propTypes={},S.Content=m,S.Header=y,S.List=k,S.Item=x}},function(e){e.O(0,[774,351,967,990,18,900,129,19,888,179],(function(){return t=5511,e(e.s=t);var t}));var t=e.O();_N_E=t}]);