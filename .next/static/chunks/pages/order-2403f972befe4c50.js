(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[941],{3376:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/order",function(){return a(2538)}])},2538:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return L}});var n=a(4111),s=a(7568),r=a(1438),i=a(2951),c=a(4924),o=a(8029),l=a(5950),d=a(4051),h=a.n(d),u=a(5893),p=a(7294),m=a(1061),x=a.n(m),g=a(3623),j=a(4623),_=a(8005),f=a(7462),y=a(6010),k=a(8459),v=a(8935),b=a(2519),N=a(2248);function Z(e){var t=e.children,a=e.className,n=e.clearing,s=e.content,r=e.fitted,i=e.hidden,c=e.horizontal,o=e.inverted,l=e.section,d=e.vertical,h=(0,y.Z)("ui",(0,k.lG)(n,"clearing"),(0,k.lG)(r,"fitted"),(0,k.lG)(i,"hidden"),(0,k.lG)(c,"horizontal"),(0,k.lG)(o,"inverted"),(0,k.lG)(l,"section"),(0,k.lG)(d,"vertical"),"divider",a),u=(0,v.Z)(Z,e),m=(0,b.Z)(Z,e);return p.createElement(m,(0,f.Z)({},u,{className:h}),N.kK(t)?s:t)}Z.handledProps=["as","children","className","clearing","content","fitted","hidden","horizontal","inverted","section","vertical"],Z.propTypes={};var w=Z,S=a(8936),T=a(967),P=a(5150),C=a(9008),A=a.n(C),O=a(6245),I=a(8286),E=a(1163),M=a.n(E),z=a(5152),G=a.n(z)()((function(){return a.e(852).then(a.t.bind(a,1852,23))}),{loadableGenerated:{webpack:function(){return[1852]}},ssr:!1}),R=function(e){(0,o.Z)(a,e);var t=(0,l.Z)(a);function a(e){var i;(0,r.Z)(this,a),i=t.call(this,e),(0,c.Z)((0,n.Z)(i),"state",{isAunthenticated:!1,attributeValue:"Pick at Station",attributeValue1:"M-PESA",data:[],user_id:0,cart_id:0,transactionId:"",phone_number:"",errorMessage:""});var o=(0,n.Z)(i);(0,c.Z)((0,n.Z)(i),"executingTokenLogics",(0,s.Z)(h().mark((function e(){var t,a,n,s,r,i,c,l,d,u;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=localStorage.getItem("authTokens")?JSON.parse(localStorage.getItem("authTokens")):null){e.next=6;break}return console.log("You needed to login, no records"),o.setState({isAunthenticated:!1}),e.abrupt("return");case 6:if(a=(0,O.Z)(t.refresh),n=a.exp,console.log("Hey this is the expire date of the refreshToken"),console.log(n),console.log("Lets try to access the json access token"),console.log(t.access),s=(0,O.Z)(t.access),console.log("This is expiring time for you..."),console.log(s),r=s.user_id,o.setState({user_id:r}),console.log("This is user_id for you"),console.log(r),i=s.exp,console.log(i),!(1e3*i-Date.now()<1)){e.next=40;break}if(console.log("Hey we need to either update or make user login again"),!(1e3*n-Date.now<1)){e.next=28;break}return console.log("Even ur refresh token has already been expired we need you to login again...."),o.setState({isAunthenticated:!1}),e.abrupt("return");case 28:return console.log("Our refresh token is alive you should use it to update your access token"),o.updateToken(t.refresh),o.setState({isAunthenticated:!0}),e.next=33,fetch("".concat(I.Z,"/api/cartproducts/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:r})});case 33:return c=e.sent,e.next=36,c.json();case 36:(l=e.sent).message||o.setState({data:l,cart_id:l[0].get_cartId}),e.next=48;break;case 40:return o.setState({isAunthenticated:!0}),e.next=43,fetch("".concat(I.Z,"/api/cartproducts/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:r})});case 43:return d=e.sent,e.next=46,d.json();case 46:(u=e.sent).message||o.setState({data:u,cart_id:u[0].get_cartId});case 48:e.next=55;break;case 50:e.prev=50,e.t0=e.catch(0),console.log(e.t0.message),console.log("Invalid token specified since, when the token is expired the jwt automatically change your storage and it ill look like this"),o.setState({isAunthenticated:!1});case 55:case"end":return e.stop()}}),e,null,[[0,50]])}))));var l=(0,n.Z)(i);return(0,c.Z)((0,n.Z)(i),"onPlaceOrder",function(){var e=(0,s.Z)(h().mark((function e(t){var a,n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),0!==l.state.transactionId.trim().length&&0!==l.state.phone_number.trim().length){e.next=7;break}return console.log("we dont accept empty string..."),l.setState({errorMessage:"Failed, We don't accept empty fields"}),l.err.current.style.display="block",l.timeout=setTimeout((function(){l.err.current.style.display="none"}),5e3),e.abrupt("return");case 7:if(!(l.state.phone_number.trim().length<10)){e.next=12;break}return l.setState({errorMessage:"Failed, phone number looks to be invalid!"}),l.err.current.style.display="block",l.timeout=setTimeout((function(){l.err.current.style.display="none"}),5e3),e.abrupt("return");case 12:return e.next=14,fetch("".concat(I.Z,"/api/create_order/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transactionId:l.state.transactionId,mobile:parseInt(l.state.phone_number),id:l.state.user_id,cartId:l.state.cart_id})});case 14:return a=e.sent,e.next=17,a.json();case 17:if(n=e.sent,console.log("This is the data you received from the server....."),console.log(n),!n.success){e.next=24;break}return e.abrupt("return",M().push({pathname:"/done",query:{unique_id:n.unique_id}}));case 24:console.log("Something is wrong here...");case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,c.Z)((0,n.Z)(i),"updateToken",function(){var e=(0,s.Z)(h().mark((function e(t){var a,n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(I.Z,"/api/token/refresh/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:t})});case 2:return a=e.sent,e.next=5,a.json();case 5:n=e.sent,localStorage.setItem("authTokens",JSON.stringify(n));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),i.err=p.createRef(),i.muamala=p.createRef(),i.phone=p.createRef(),i}return(0,i.Z)(a,[{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}},{key:"componentDidMount",value:function(){var e=this;return(0,s.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("This is value of isAunthenticated ",e.state.isAunthenticated),e.executingTokenLogics(),e.executingTokenLogicsInterval=setInterval((function(){return e.executingTokenLogics()}),12e5);case 3:case"end":return t.stop()}}),t)})))()}},{key:"render",value:function(){var e=this;return(0,u.jsxs)("div",{className:x().baba,children:[(0,u.jsxs)(A(),{children:[(0,u.jsx)("title",{children:"PERSONALYZER"}),(0,u.jsx)("link",{rel:"stylesheet",href:"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css",integrity:"sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T",crossorigin:"anonymous"}),(0,u.jsx)("link",{rel:"stylesheet",href:"//cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.12/semantic.min.css"})]}),this.state.isAunthenticated?this.state.data.length>0?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(G,{maxWidth:899,children:(0,u.jsx)("div",{className:x().sendMeCenter,children:(0,u.jsxs)("div",{className:x().mode,children:[(0,u.jsx)("p",{className:x().titl,children:"Select mode of payment"}),(0,u.jsx)("div",{className:x().mpe,children:(0,u.jsx)("button",{className:x().mpeBtn,onClick:function(){return M().push("/mpesa")},children:"M-PESA"})}),(0,u.jsx)("div",{className:x().tigopesa,children:(0,u.jsx)("button",{className:x().tigBtn,onClick:function(){return M().push("/tigopesa")},children:"TIGO PESA"})})]})})}),(0,u.jsx)(G,{minWidth:900,children:(0,u.jsx)("div",{className:x().test,children:(0,u.jsxs)("div",{className:x().toto,children:[(0,u.jsxs)("div",{className:x().topSeg,children:[(0,u.jsx)(g.Z,{attached:"top",as:"h1",textAlign:"center",color:"grey",content:"Place Order by Confirming payment and Delivery method"}),(0,u.jsx)(j.Z,{attached:!0,placeholder:!0,children:(0,u.jsx)("div",{style:{marginLeft:"2%"},children:(0,u.jsxs)(_.Z,{columns:2,children:[(0,u.jsx)(w,{vertical:!0,children:"|"}),(0,u.jsxs)(_.Z.Row,{children:[(0,u.jsx)(_.Z.Column,{children:(0,u.jsxs)(S.Z,{children:[(0,u.jsxs)(S.Z.Field,{children:[(0,u.jsx)("label",{style:{color:"grey"},children:"Transaction number/Namba ya muamala"}),(0,u.jsx)("input",{onChange:function(t){return e.setState({transactionId:t.target.value})}})]}),(0,u.jsxs)(S.Z.Field,{children:[(0,u.jsx)("label",{style:{color:"grey"},children:"Phone number"}),(0,u.jsx)("input",{onChange:function(t){return e.setState({phone_number:t.target.value})}})]}),(0,u.jsxs)("div",{className:x().error,ref:this.err,children:[(0,u.jsx)("img",{src:"../static/images/warning.png",width:12}),(0,u.jsx)("span",{className:x().neno1,children:this.state.errorMessage})]}),(0,u.jsx)(T.Z,{color:"black",fluid:!0,type:"submit",onClick:this.onPlaceOrder,children:"Place Order"})]})}),(0,u.jsxs)(_.Z.Column,{children:[(0,u.jsxs)("div",{className:x().not1Wrapper,children:[(0,u.jsx)("p",{className:x().hint,children:"For picking your product at station, use this address:"}),(0,u.jsx)("div",{className:x().addr,children:(0,u.jsx)("address",{children:(0,u.jsxs)("i",{children:["Kariakoo, Aggrey na Likoma Street,",(0,u.jsx)("br",{}),"Dar es salaam,",(0,u.jsx)("br",{}),"0623317196,",(0,u.jsx)("br",{}),"onlinetek@gmail.com"]})})})]}),(0,u.jsxs)("div",{className:x().not2Wrapper,children:[(0,u.jsxs)("p",{className:x().hint2,children:["***Contact us to deliver a product anywhere in Tanzania.",(0,u.jsx)("br",{}),"***Contact us if you face any problem about the payment."]}),(0,u.jsxs)("div",{className:x().bt,children:[(0,u.jsxs)("span",{style:{fontWeight:"bold",color:"grey",marginRight:"5%"},children:[(0,u.jsx)(P.Z,{size:"large",name:"whatsapp",color:"black"}),"+255623317196"]}),(0,u.jsxs)("span",{style:{fontWeight:"bold",color:"grey",marginRight:"4%"},children:[(0,u.jsx)(P.Z,{size:"large",name:"instagram",color:"black"}),"@personalizer"]}),(0,u.jsxs)("span",{style:{fontWeight:"bold",color:"grey"},children:[(0,u.jsx)(P.Z,{size:"large",name:"mail outline",color:"black"}),"support@personalizer.co.tz"]})]})]})]})]})]})})})]}),(0,u.jsxs)(_.Z,{children:[(0,u.jsx)(_.Z.Column,{width:10,children:(0,u.jsx)("div",{className:x().seg2,children:(0,u.jsxs)(j.Z,{children:[(0,u.jsx)(g.Z,{as:"h1",color:"grey",content:"Mode of Payments"}),(0,u.jsx)("hr",{}),(0,u.jsxs)("div",{children:[(0,u.jsx)("h3",{className:x().mpesa,children:"M-PESA"}),(0,u.jsxs)(_.Z,{children:[(0,u.jsx)(_.Z.Column,{width:8,children:(0,u.jsxs)("div",{style:{marginLeft:"5%"},children:[(0,u.jsx)("p",{className:x().lnamba,children:"LIPA NAMBA"}),(0,u.jsx)("span",{className:x().aname1,children:"111000"})]})}),(0,u.jsx)(_.Z.Column,{width:8,children:(0,u.jsxs)("div",{style:{marginLeft:"5%"},children:[(0,u.jsx)("p",{className:x().qr,children:"QR CODE"}),(0,u.jsx)("p",{className:x().aqr,children:(0,u.jsx)("img",{width:150,height:150,src:"../static/images/frame.png"})})]})})]})]}),(0,u.jsxs)("div",{style:{marginTop:"2%"},children:[(0,u.jsx)("h3",{className:x().tpesa,children:"TIGO PESA"}),(0,u.jsxs)(_.Z,{children:[(0,u.jsx)(_.Z.Column,{width:8,children:(0,u.jsxs)("div",{style:{marginLeft:"5%"},children:[(0,u.jsx)("p",{className:x().lnamba,children:"LIPA NAMBA"}),(0,u.jsx)("span",{className:x().aname,children:"111234"})]})}),(0,u.jsx)(_.Z.Column,{width:8,children:(0,u.jsxs)("div",{style:{marginLeft:"5%"},children:[(0,u.jsx)("p",{className:x().qr,children:"QR CODE"}),(0,u.jsx)("p",{className:x().aqr,children:(0,u.jsx)("img",{width:150,height:150,src:"../static/images/frame.png"})})]})})]})]})]})})}),(0,u.jsxs)(_.Z.Column,{width:6,children:[(0,u.jsxs)("div",{className:x().p1,children:[(0,u.jsx)(g.Z,{as:"h2",color:"grey",attached:"top",content:"Jinsi ya kulipia kwa M-PESA"}),(0,u.jsx)(j.Z,{attached:!0,children:(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{className:x().hd,children:(0,u.jsx)("h3",{className:x().kichwa,children:"Kwa njia ya kawaida"})}),(0,u.jsxs)("div",{className:x().para,children:[(0,u.jsx)("p",{children:"1. Piga *150*00#"}),(0,u.jsx)("p",{children:"2. "})]}),(0,u.jsx)("div",{className:x().hd1,children:(0,u.jsx)("h3",{className:x().kichwa,children:"Kwa kutumia M-PESA app."})}),(0,u.jsxs)("div",{className:x().para,children:[(0,u.jsx)("p",{children:"1. Fungua app yako ya M-PESA"}),(0,u.jsx)("p",{children:"2. Juu upande wa kulia bonyeza picha ya QR code"})]})]})})]}),(0,u.jsxs)("div",{className:x().p2,children:[(0,u.jsx)(g.Z,{attached:"top",as:"h2",color:"grey",content:"Jinsi ya kulipia kwa TIGO PESA"}),(0,u.jsx)(j.Z,{attached:!0,children:(0,u.jsxs)("div",{children:[(0,u.jsx)("div",{className:x().hd2,children:(0,u.jsx)("h3",{className:x().kichwa,children:"Kwa njia ya kawaida"})}),(0,u.jsxs)("div",{className:x().para,children:[(0,u.jsx)("p",{children:"1. Piga *150*01#"}),(0,u.jsx)("p",{children:"2. Chagua 5(Lipa kwa simu) "}),(0,u.jsx)("p",{children:"3. Chagua 1(Kwenda Tigo Pesa)"}),(0,u.jsx)("p",{children:"4. Ingiza lipa namba "}),(0,u.jsx)("p",{children:"5. Ingiza kiasi cha kulipia"}),(0,u.jsx)("p",{children:"6. Ingiza namba ya siri kuthibitisha"})]}),(0,u.jsx)("div",{className:x().hd3,children:(0,u.jsx)("h3",{className:x().kichwa,children:"Kwa kutumia TIGO PESA app."})}),(0,u.jsxs)("div",{className:x().para,children:[(0,u.jsx)("p",{children:"1. Fungua app ya TIGO PESA"}),(0,u.jsx)("p",{children:"2.Chagua lipa kwa simu"}),(0,u.jsx)("p",{children:"3. Changua njia ya kufanya malipo kwa kuingiza lipa namba au kuskani picha ya QR"}),(0,u.jsx)("p",{children:"4. Ingiza kiasi cha kulipia"}),(0,u.jsx)("p",{children:"5. Ingiza namba ya siri kuthibitisha"})]})]})})]})]})]})]})})})]}):(0,u.jsx)("div",{children:"Your cart is empty, You can't place order for empty cart..."}):(0,u.jsx)("div",{children:"You're needed to be Aunthenticated..."})]})}}]),a}(p.Component),L=R},8286:function(e,t){"use strict";t.Z="https://web-production-0b93.up.railway.app"},1061:function(e){e.exports={baba:"order_baba__I__y4",topSeg:"order_topSeg__Po2oc",test:"order_test__wAGOe",toto:"order_toto__PVSsc",seg1:"order_seg1__sOyyu",seg2:"order_seg2__i6BkE",p1:"order_p1__632Rq",p2:"order_p2__SvoD_",hd:"order_hd__5zUdB",kichwa:"order_kichwa__GtHG2",para:"order_para__t6sMn",hd1:"order_hd1__mYgYY",hd2:"order_hd2__QhH3l",hd3:"order_hd3__Bi6a6",mpesa:"order_mpesa__9UO1f",tpesa:"order_tpesa__GtKZ_",lnamba:"order_lnamba__YPzpU",qr:"order_qr__X1_IN",aname:"order_aname__jsEpY",aname1:"order_aname1__MoV6C",hint:"order_hint__Ku2v3",addr:"order_addr__FeWjp",hint2:"order_hint2__WxlFa",bt:"order_bt__v5X_s",error:"order_error__26_t6",sendMeCenter:"order_sendMeCenter__Jq2_A",titl:"order_titl__9_S1x",mpe:"order_mpe__F15qg",mpeBtn:"order_mpeBtn__Pu9mR",tigBtn:"order_tigBtn__Sa0rr"}}},function(e){e.O(0,[643,967,990,900,774,888,179],(function(){return t=3376,e(e.s=t);var t}));var t=e.O();_N_E=t}]);